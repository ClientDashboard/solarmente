'use client';

import { useState, useEffect } from 'react';
import { useSearchParams } from 'next/navigation';
import Image from 'next/image';
import Link from 'next/link';
import { Bar } from 'react-chartjs-2';
import {
  Chart as ChartJS,
  CategoryScale,
  LinearScale,
  BarElement,
  Title,
  Tooltip,
  Legend,
} from 'chart.js';

// Register Chart.js components
ChartJS.register(
  CategoryScale,
  LinearScale,
  BarElement,
  Title,
  Tooltip,
  Legend
);

export default function ProposalResult() {
  const searchParams = useSearchParams();
  const [activeTab, setActiveTab] = useState('resumen');
  const [proposalData, setProposalData] = useState<any>(null);

  useEffect(() => {
    // Get query parameters
    const nombre = searchParams.get('nombre') || '';
    const telefono = searchParams.get('telefono') || '';
    const email = searchParams.get('email') || '';
    const consumo = Number(searchParams.get('consumo') || '1000');

    // Calculate proposal details
    const systemSize = calculateSystemSize(consumo);
    const panelCount = calculatePanelCount(systemSize);
    const roofSpace = calculateRoofSpace(panelCount);
    const savings25Years = calculateLongTermSavings(consumo);
    const annualSavings = calculateAnnualSavings(consumo);
    const monthlyData = generateMonthlyData(systemSize);
    const monthlyProduction = calculateMonthlyProduction(systemSize);
    const roi = calculateROI(consumo, systemSize);
    const oilReduction = calculateOilReduction(systemSize);
    const co2Reduction = calculateCO2Reduction(systemSize);
    const systemPrice = calculateSystemPrice(systemSize);

    // Set all calculated data
    setProposalData({
      cliente: {
        nombre,
        telefono,
        email,
        consumo
      },
      sistema: {
        tamano: systemSize,
        paneles: panelCount,
        espacioTecho: roofSpace,
        tamanoPanel: 585, // Panel size in Watts
        inversores: Math.ceil(systemSize / 23),
        detalle_inversores: `(${Math.ceil(systemSize / 23)}) 23kW trifasico (SOLIS)`,
        roi: roi
      },
      financiero: {
        ahorro25Anos: savings25Years,
        ahorroAnual: annualSavings,
        ahorroMensual: annualSavings / 12,
        porcentajeAhorro: 100
      },
      ambiental: {
        petroleoReducido: oilReduction,
        co2Reducido: co2Reduction
      },
      produccion: {
        mensual: monthlyData,
        promedioMensual: monthlyProduction
      },
      precios: {
        plan1: {
          sistema: systemPrice * 0.8, // System cost
          instalacion: 4000,
          tramites: 1000,
          planos: 1000,
          total: (systemPrice * 0.8) + 6000,
          abono1: ((systemPrice * 0.8) + 6000) * 0.5, // 50%
          abono2: ((systemPrice * 0.8) + 6000) * 0.4, // 40%
          abono3: ((systemPrice * 0.8) + 6000) * 0.1, // 10%
        },
        plan2: {
          sistema: systemPrice * 0.87, // Higher price for financing
          instalacion: 4000,
          tramites: 1000,
          planos: 1000,
          total: (systemPrice * 0.87) + 6000,
          financiado: {
            abono: ((systemPrice * 0.87) + 6000) * 0.55, // Initial payment
            saldo: ((systemPrice * 0.87) + 6000) * 0.45, // Remaining balance
            cuotaMensual: (((systemPrice * 0.87) + 6000) * 0.45) / 6, // Monthly payment
            totalFinanciado: (((systemPrice * 0.87) + 6000) * 0.45) * 1.05 // With interest
          }
        }
      }
    });
  }, [searchParams]);

  // Calculation functions
  const calculateSystemSize = (consumo: number): number => {
    // Calculate system size based on monthly consumption
    // Assuming 4.5 kWh per 1 kW of solar per day in average conditions
    // Monthly: 4.5 * 30 = 135 kWh per 1 kW of solar
    return Number((consumo / 135).toFixed(2));
  };

  const calculatePanelCount = (systemSize: number): number => {
    // Assuming 585W panels
    return Math.ceil(systemSize * 1000 / 585);
  };

  const calculateRoofSpace = (panelCount: number): number => {
    // Assuming 2 m² per panel
    return Math.ceil(panelCount * 2);
  };

  const calculateLongTermSavings = (consumo: number): number => {
    // Simple estimate: Monthly consumption * $0.15/kWh * 12 months * 25 years
    return Math.round(consumo * 0.15 * 12 * 25);
  };

  const calculateAnnualSavings = (consumo: number): number => {
    // Monthly consumption * $0.15/kWh * 12 months
    return Math.round(consumo * 0.15 * 12);
  };

  const calculateMonthlyProduction = (systemSize: number): number => {
    // Average monthly production: systemSize * 135 kWh
    return Math.round(systemSize * 135);
  };

  const generateMonthlyData = (systemSize: number): number[] => {
    // Seasonal variations - these are sample values
    const monthlyFactors = [1.1, 1.2, 1.3, 1.2, 1.0, 0.9, 0.9, 1.0, 1.1, 1.0, 0.9, 1.0];
    return monthlyFactors.map(factor => Math.round(systemSize * 135 * factor));
  };

  const calculateROI = (consumo: number, systemSize: number): number => {
    // ROI = Investment / Annual Savings
    const investment = calculateSystemPrice(systemSize);
    const annualSavings = calculateAnnualSavings(consumo);
    return Math.round(investment / annualSavings);
  };

  const calculateOilReduction = (systemSize: number): number => {
    // Each kW of solar prevents approximately 1.5 barrels of oil per year
    // 1 barrel = 42 gallons
    return Math.round(systemSize * 1.5 * 42);
  };

  const calculateCO2Reduction = (systemSize: number): number => {
    // Each kW of solar prevents approximately 0.9 tons of CO2 per year
    return Math.round(systemSize * 0.9);
  };

  const calculateSystemPrice = (systemSize: number): number => {
    // Base price at $1000 per kW
    return Math.round(systemSize * 1000);
  };

  if (!proposalData) {
    return (
      <div className="flex justify-center items-center min-h-screen">
        <div className="animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-solarmente-button"></div>
      </div>
    );
  }

  const monthNames = [
    'enero', 'febrero', 'marzo', 'abril', 'mayo', 'junio',
    'julio', 'agosto', 'septiembre', 'octubre', 'noviembre', 'diciembre'
  ];

  const chartData = {
    labels: monthNames,
    datasets: [
      {
        label: 'Generación kWh',
        data: proposalData.produccion.mensual,
        backgroundColor: '#FF371E',
        barThickness: 20,
      },
    ],
  };

  const chartOptions = {
    responsive: true,
    maintainAspectRatio: false,
    scales: {
      y: {
        beginAtZero: true,
        title: {
          display: true,
          text: 'kWh',
          color: '#323131',
        },
        ticks: {
          color: '#323131',
        }
      },
      x: {
        ticks: {
          color: '#323131',
        }
      }
    },
    plugins: {
      legend: {
        display: false,
      },
      tooltip: {
        backgroundColor: '#FFFFFF',
        titleColor: '#060100',
        bodyColor: '#323131',
        borderColor: '#EEEEEE',
        borderWidth: 1,
      }
    },
  };

  return (
    <main className="min-h-screen bg-gray-50 py-8">
      <div className="container mx-auto px-4">
        {/* Proposal Header */}
        <div className="bg-white rounded-lg shadow-lg overflow-hidden mb-8 border border-gray-200">
          {/* First Page - Summary */}
          <div className="border-b border-gray-200">
            <div className="flex justify-center py-6">
              <Image 
                src="/images/logo.png" 
                alt="SolarMente Logo" 
                width={220} 
                height={60} 
                className="h-14 w-auto" 
              />
            </div>

            <div className="px-6 pb-6">
              <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div>
                  <div className="mb-6">
                    <h2 className="text-xl font-semibold text-solarmente-title mb-2">
                      Tamaño de sistema solar ofrecido:
                    </h2>
                    <p className="text-4xl font-bold text-solarmente-button">
                      {proposalData.sistema.tamano} kW
                    </p>
                  </div>

                  <div className="mt-6">
                    {/* House illustrations */}
                    <div className="h-40 w-full bg-contain bg-center bg-no-repeat" 
                         style={{backgroundImage: 'url("/images/houses-illustration.png")'}}></div>
                  </div>
                </div>

                <div>
                  <div className="grid grid-cols-2 gap-4">
                    <div className="mb-2">
                      <p className="text-solarmente-text">% de Ahorro</p>
                      <div className="bg-white border border-gray-200 text-right p-2 rounded">
                        <p className="text-xl font-bold text-solarmente-title">{proposalData.financiero.porcentajeAhorro}%</p>
                      </div>
                    </div>
                    
                    <div className="mb-2">
                      <p className="text-solarmente-text">Ahorro a 25 años</p>
                      <div className="bg-white border border-gray-200 text-right p-2 rounded">
                        <p className="text-xl font-bold text-solarmente-title">$ {proposalData.financiero.ahorro25Anos.toLocaleString()}</p>
                      </div>
                    </div>
                    
                    <div className="mb-2">
                      <p className="text-solarmente-text">Retorno de Inversion</p>
                      <div className="bg-white border border-gray-200 text-right p-2 rounded">
                        <p className="text-xl font-bold text-solarmente-title">{proposalData.sistema.roi} Años</p>
                      </div>
                    </div>
                    
                    <div className="mb-2">
                      <p className="text-solarmente-text">Tamaño de panel solar (Watts)</p>
                      <div className="bg-white border border-gray-200 text-right p-2 rounded">
                        <p className="text-xl font-bold text-solarmente-title">{proposalData.sistema.tamanoPanel}</p>
                      </div>
                    </div>
                    
                    <div className="mb-2">
                      <p className="text-solarmente-text">Cantidad de Panels Solares a usar</p>
                      <div className="bg-white border border-gray-200 text-right p-2 rounded">
                        <p className="text-xl font-bold text-solarmente-title">{proposalData.sistema.paneles}</p>
                      </div>
                    </div>
                    
                    <div className="mb-2">
                      <p className="text-solarmente-text">Cantidad de Inversores</p>
                      <div className="bg-white border border-gray-200 text-right p-2 rounded">
                        <p className="text-base font-bold text-solarmente-title">{proposalData.sistema.detalle_inversores}</p>
                      </div>
                    </div>
                    
                    <div className="mb-2">
                      <p className="text-solarmente-text">Espacio requerido de techo (m2)</p>
                      <div className="bg-white border border-gray-200 text-right p-2 rounded">
                        <p className="text-xl font-bold text-solarmente-title">{proposalData.sistema.espacioTecho}</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          {/* Tabs */}
          <div className="border-b border-gray-200">
            <nav className="flex -mb-px">
              <button
                onClick={() => setActiveTab('resumen')}
                className={`py-4 px-6 text-center border-b-2 font-medium text-sm ${
                  activeTab === 'resumen'
                    ? 'border-solarmente-button text-solarmente-button'
                    : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'
                }`}
              >
                Resumen
              </button>
              <button
                onClick={() => setActiveTab('detalles')}
                className={`py-4 px-6 text-center border-b-2 font-medium text-sm ${
                  activeTab === 'detalles'
                    ? 'border-solarmente-button text-solarmente-button'
                    : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'
                }`}
              >
                Detalles Técnicos
              </button>
              <button
                onClick={() => setActiveTab('financiero')}
                className={`py-4 px-6 text-center border-b-2 font-medium text-sm ${
                  activeTab === 'financiero'
                    ? 'border-solarmente-button text-solarmente-button'
                    : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'
                }`}
              >
                Opciones de Pago
              </button>
              <button
                onClick={() => setActiveTab('proyectos')}
                className={`py-4 px-6 text-center border-b-2 font-medium text-sm ${
                  activeTab === 'proyectos'
                    ? 'border-solarmente-button text-solarmente-button'
                    : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'
                }`}
              >
                Proyectos
              </button>
            </nav>
          </div>

          {/* Tab Content */}
          <div className="p-6">
            {activeTab === 'resumen' && (
              <div>
                <h2 className="text-xl font-bold mb-6 text-solarmente-title">Resumen de la Propuesta</h2>
                
                <div className="bg-solarmente-button text-white p-3 mb-6 rounded-md">
                  <h3 className="text-center font-semibold text-lg">GENERACION DE SISTEMA AÑO 1 (ESTIMADO)</h3>
                </div>
                
                <div className="h-64 mb-6">
                  <Bar data={chartData} options={chartOptions} />
                </div>
                
                <div className="bg-solarmente-button text-white p-3 mb-6 rounded-md">
                  <h3 className="text-center font-semibold text-lg">AHORROS ESTIMADOS</h3>
                </div>
                
                <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                  <div className="bg-white border border-gray-200 p-4 rounded-md">
                    <h3 className="text-center mb-3 text-solarmente-text">Nuevo Consumo esperado prom. del Cliente (kWh)</h3>
                    <p className="text-center text-2xl font-bold text-solarmente-title">-{proposalData.financiero.ahorroMensual.toFixed(2)}</p>
                  </div>
                  
                  <div className="bg-white border border-gray-200 p-4 rounded-md">
                    <h3 className="text-center mb-3 text-solarmente-text">Total año 1 nuevo importe a pagar a cia de luz</h3>
                    <p className="text-center text-2xl font-bold text-solarmente-title">-${(proposalData.financiero.ahorroAnual).toFixed(2)}</p>
                  </div>
                  
                  <div className="bg-white border border-gray-200 p-4 rounded-md">
                    <h3 className="text-center mb-3 text-solarmente-text">Produccion FV prom. Mensual (kWh)</h3>
                    <p className="text-center text-2xl font-bold text-solarmente-title">{proposalData.produccion.promedioMensual.toFixed(2)}</p>
                  </div>
                  
                  <div className="bg-white border border-gray-200 p-4 rounded-md">
                    <h3 className="text-center mb-3 text-solarmente-text">Ahorro Total Annual</h3>
                    <p className="text-center text-2xl font-bold text-solarmente-title">$ {proposalData.financiero.ahorroAnual.toLocaleString()}</p>
                  </div>
                </div>
                
                <div className="bg-solarmente-button text-white p-3 mb-6 rounded-md">
                  <h3 className="text-center font-semibold text-lg">BENEFICIOS AMBIENTALES</h3>
                </div>
                
                <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                  <div className="bg-white border border-gray-200 p-4 rounded-md">
                    <h3 className="text-center mb-3 text-solarmente-text">Consumo de petróleo reducido (galones)</h3>
                    <p className="text-center text-2xl font-bold text-solarmente-title">{proposalData.ambiental.petroleoReducido}</p>
                  </div>
                  
                  <div className="bg-white border border-gray-200 p-4 rounded-md">
                    <h3 className="text-center mb-3 text-solarmente-text">Reduccion de gases CO2 (toneladas)</h3>
                    <p className="text-center text-2xl font-bold text-solarmente-title">{proposalData.ambiental.co2Reducido}</p>
                  </div>
                </div>
                
                <div className="flex justify-center mt-8">
                  <button className="bg-solarmente-button hover:bg-opacity-90 text-white font-bold py-3 px-8 rounded-lg shadow-lg transition duration-200">
                    Solicitar Instalación
                  </button>
                </div>
              </div>
            )}
            
            {activeTab === 'detalles' && (
              <div>
                <h2 className="text-xl font-bold mb-6 text-solarmente-title">DETALLES DE LA PROPUESTA</h2>
                
                <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                  <div>
                    <div className="bg-solarmente-button text-white p-3 mb-4 rounded-md">
                      <h3 className="text-center font-semibold">GARANTIAS</h3>
                    </div>
                    
                    <div className="grid grid-cols-2 gap-4">
                      <div className="text-solarmente-text">Panel Solar</div>
                      <div className="bg-white border border-gray-200 text-center p-2 rounded">
                        <p className="font-semibold text-solarmente-title">30 años</p>
                      </div>
                      
                      <div className="text-solarmente-text">Estructura de montaje</div>
                      <div className="bg-white border border-gray-200 text-center p-2 rounded">
                        <p className="font-semibold text-solarmente-title">15 años</p>
                      </div>
                      
                      <div className="text-solarmente-text">Inversores</div>
                      <div className="bg-white border border-gray-200 text-center p-2 rounded">
                        <p className="font-semibold text-solarmente-title">10 años</p>
                      </div>
                    </div>
                  </div>
                  
                  <div>
                    <div className="bg-solarmente-button text-white p-3 mb-4 rounded-md">
                      <h3 className="text-center font-semibold">TIEMPOS ESTIMADOS (tramites)</h3>
                    </div>
                    
                    <div className="space-y-2">
                      <p className="text-solarmente-text">Confeccion de planos: <span className="font-semibold text-solarmente-title">1 semana</span></p>
                      <p className="text-solarmente-text">Tramites Municipales: <span className="font-semibold text-solarmente-title">4 - 5 meses</span></p>
                      <p className="text-solarmente-text">Tramites con Entidad Electrica: <span className="font-semibold text-solarmente-title">1 - 2 meses</span></p>
                    </div>
                  </div>
                </div>
                
                <div className="bg-solarmente-button text-white p-3 mb-4 rounded-md">
                  <h3 className="text-center font-semibold">PROPUESTA INCLUYE</h3>
                </div>
                
                <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                  <div>
                    <ul className="list-disc pl-5 text-solarmente-text space-y-2">
                      <li>Confeccion de plano</li>
                      <li>Tramites de gestion de nuevo medidor bidireccional</li>
                      <li>Permiso de conexión del sistema</li>
                      <li>Suministro e instalacion del sistema</li>
                      <li>Instalacion de monitoreo via internet para dispositivos moviles</li>
                      <li>Puesta en marcha del sistema</li>
                    </ul>
                  </div>
                  
                  <div className="flex justify-center items-center">
                    <img src="/images/solar-monitoring.png" alt="Monitoreo Solar" className="max-w-full h-auto" />
                  </div>
                </div>
                
                <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                  <div>
                    <div className="bg-solarmente-button text-white p-3 mb-4 rounded-md">
                      <h3 className="text-center font-semibold">MANTENIMIENTO ANUAL</h3>
                    </div>
                    
                    <p className="font-bold text-solarmente-title mb-4">El primer año es totalmente GRATIS.</p>
                    
                    <p className="text-solarmente-text">
                      Mantenimiento es 1 vez al año costo annual: <span className="font-semibold text-solarmente-title">$260</span>
                    </p>
                  </div>
                  
                  <div>
                    <div className="bg-solarmente-button text-white p-3 mb-4 rounded-md">
                      <h3 className="text-center font-semibold">MONITOREO POR WIFI 24/7</h3>
                    </div>
                    
                    <p className="text-solarmente-text">
                      Te ofrecemos un dispositivo para monitorear la produccion de tu sistema el cual funciona
                      atravez del Wifi de su casa. Para poder configurarlo y pueda ver su produccion
                      desde cualquier lugar necesita tener internet WIFI con buena señal.
                    </p>
                  </div>
                </div>
                
                <div className="bg-solarmente-button text-white p-3 mb-4 rounded-md">
                  <h3 className="text-center font-semibold">OBSERVACION</h3>
                </div>
                
                <p className="text-solarmente-text mb-8">
                  Nuestra propuesta es basada en su consumo, si decide tomarla debemos de realizar una visita previa para
                  verificar si la cantidad de paneles a instalar se puede realizar. <span className="text-solarmente-button font-semibold">(Precio puede variar al hacer inspección.)</span>
                </p>
                
                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                  <div>
                    <div className="bg-solarmente-button text-white p-3 mb-4 rounded-md">
                      <h3 className="text-center font-semibold">MARCA INVERSOR</h3>
                    </div>
                    
                    <div className="flex justify-center">
                      <img src="/images/solis-logo.png" alt="Solis" className="h-16" />
                    </div>
                  </div>
                  
                  <div>
                    <div className="bg-solarmente-button text-white p-3 mb-4 rounded-md">
                      <h3 className="text-center font-semibold">MARCA PANEL SOLAR</h3>
                    </div>
                    
                    <div className="flex justify-center">
                      <img src="/images/longi-logo.png" alt="Longi" className="h-16" />
                    </div>
                  </div>
                </div>
              </div>
            )}
            
            {activeTab === 'financiero' && (
              <div>
                <h2 className="text-xl font-bold mb-6 text-solarmente-title">PRECIO DEL SISTEMA</h2>
                
                <div className="grid grid-cols-1 md:grid-cols-2 gap-10 mb-8">
                  {/* Plan 1 */}
                  <div className="border border-gray-200 rounded-lg shadow-md overflow-hidden">
                    <div className="bg-solarmente-button text-white p-3">
                      <h3 className="text-center font-semibold text-lg">PRECIO PLAN 1</h3>
                    </div>
                    
                    <div className="p-4">
                      <div className="space-y-2 mb-6">
                        <div className="flex justify-between">
                          <span className="text-solarmente-text">Precio del sistema - Completo</span>
                          <span className="font-semibold text-solarmente-title">${proposalData.precios.plan1.sistema.toLocaleString()}</span>
                        </div>
                        <div className="flex justify-between">
                          <span className="text-solarmente-text">Instalacion</span>
                          <span className="font-semibold text-solarmente-title">${proposalData.precios.plan1.instalacion.toLocaleString()}</span>
                        </div>
                        <div className="flex justify-between">
                          <span className="text-solarmente-text">Tramites</span>
                          <span className="font-semibold text-solarmente-title">${proposalData.precios.plan1.tramites.toLocaleString()}</span>
                        </div>
                        <div className="flex justify-between">
                          <span className="text-solarmente-text">Confeccion de Planos</span>
                          <span className="font-semibold text-solarmente-title">${proposalData.precios.plan1.planos.toLocaleString()}</span>
                        </div>
                        <div className="flex justify-between font-semibold">
                          <span className="text-solarmente-text">Sub - Total</span>
                          <span className="text-solarmente-title">${proposalData.precios.plan1.total.toLocaleString()}</span>
                        </div>
                        <div className="border-t border-gray-200 pt-2 flex justify-between font-bold">
                          <span className="text-solarmente-title">Gran Total</span>
                          <span className="text-solarmente-button">${proposalData.precios.plan1.total.toLocaleString()}</span>
                        </div>
                        <div className="flex justify-between text-sm">
                          <span className="text-solarmente-text">PRECIO X WATT</span>
                          <span className="font-semibold text-solarmente-title">{(proposalData.precios.plan1.total / (proposalData.sistema.tamano * 1000)).toFixed(2)}</span>
                        </div>
                      </div>
                      
                      <div className="border-t border-gray-200 pt-4 mb-4">
                        <h4 className="font-bold text-center mb-2 text-solarmente-title">ABONO INCIAL DEL 50%</h4>
                        <p className="text-sm text-solarmente-text mb-3">
                          Al recibir el primer abono damos inicio a la instalacion del sistema solar en un maximo
                          de 10 dias habiles. Tambien se da inicio a los tramites.
                        </p>
                        <div className="bg-gray-100 p-2 text-center rounded-md">
                          <span className="font-bold text-lg text-solarmente-title">${proposalData.precios.plan1.abono1.toLocaleString()}</span>
                        </div>
                      </div>
                      
                      <div className="border-t border-gray-200 pt-4 mb-4">
                        <h4 className="font-bold text-center mb-2 text-solarmente-title">SEGUNDO ABONO DEL 40%</h4>
                        <p className="text-sm text-solarmente-text mb-3">
                          El segundo abono se cancela al terminar la instalacion de todos los equipos y dejar el
                          sistema en funcionamiento con inyeccion cero para obtener un ahorro mientras se
                          hacen los tramites.
                        </p>
                        <div className="bg-gray-100 p-2 text-center rounded-md">
                          <span className="font-bold text-lg text-solarmente-title">${proposalData.precios.plan1.abono2.toLocaleString()}</span>
                        </div>
                      </div>
                      
                      <div className="border-t border-gray-200 pt-4 mb-4">
                        <h4 className="font-bold text-center mb-2 text-solarmente-title">EL TERCER Y ULTIMO ABONO 10%</h4>
                        <p className="text-sm text-solarmente-text mb-3">
                          El tercer abono y ultimo abono se cancela al tener el nuevo medidor por la compañia de luz.
                        </p>
                        <div className="bg-gray-100 p-2 text-center rounded-md">
                          <span className="font-bold text-lg text-solarmente-title">${proposalData.precios.plan1.abono3.toLocaleString()}</span>
                        </div>
                      </div>
                      
                      <div className="bg-solarmente-button text-white p-3 text-center rounded-md">
                        <h4 className="font-bold">GRAN TOTAL</h4>
                        <p className="text-2xl font-bold">${proposalData.precios.plan1.total.toLocaleString()}</p>
                      </div>
                    </div>
                  </div>
                  
                  {/* Plan 2 */}
                  <div className="border border-gray-200 rounded-lg shadow-md overflow-hidden">
                    <div className="bg-solarmente-button text-white p-3">
                      <h3 className="text-center font-semibold text-lg">PRECIO PLAN 2</h3>
                    </div>
                    
                    <div className="p-4">
                      <div className="space-y-2 mb-6">
                        <div className="flex justify-between">
                          <span className="text-solarmente-text">Precio del sistema - Completo</span>
                          <span className="font-semibold text-solarmente-title">${proposalData.precios.plan2.sistema.toLocaleString()}</span>
                        </div>
                        <div className="flex justify-between">
                          <span className="text-solarmente-text">Instalacion</span>
                          <span className="font-semibold text-solarmente-title">${proposalData.precios.plan2.instalacion.toLocaleString()}</span>
                        </div>
                        <div className="flex justify-between">
                          <span className="text-solarmente-text">Tramites</span>
                          <span className="font-semibold text-solarmente-title">${proposalData.precios.plan2.tramites.toLocaleString()}</span>
                        </div>
                        <div className="flex justify-between">
                          <span className="text-solarmente-text">Confeccion de Planos</span>
                          <span className="font-semibold text-solarmente-title">${proposalData.precios.plan2.planos.toLocaleString()}</span>
                        </div>
                        <div className="flex justify-between font-semibold">
                          <span className="text-solarmente-text">Sub - Total</span>
                          <span className="text-solarmente-title">${proposalData.precios.plan2.total.toLocaleString()}</span>
                        </div>
                        <div className="border-t border-gray-200 pt-2 flex justify-between font-bold">
                          <span className="text-solarmente-title">Gran Total</span>
                          <span className="text-solarmente-button">${proposalData.precios.plan2.total.toLocaleString()}</span>
                        </div>
                        <div className="flex justify-between text-sm">
                          <span className="text-solarmente-text">PRECIO X WATT</span>
                          <span className="font-semibold text-solarmente-title">{(proposalData.precios.plan2.total / (proposalData.sistema.tamano * 1000)).toFixed(2)}</span>
                        </div>
                      </div>
                      
                      <div className="border-t border-gray-200 pt-4 mb-4">
                        <h4 className="font-bold text-center mb-2 text-solarmente-title">ABONO INCIAL</h4>
                        <p className="text-sm text-solarmente-text mb-3">
                          Al recibir el primer abono damos inicio a la instalacion del sistema solar en un maximo
                          de 10 dias habiles. Tambien se da inicio a los tramites.
                        </p>
                        <div className="bg-gray-100 p-2 text-center rounded-md">
                          <span className="font-bold text-lg text-solarmente-title">${proposalData.precios.plan2.financiado.abono.toLocaleString()}</span>
                        </div>
                      </div>
                      
                      <div className="border-t border-gray-200 pt-4 mb-4">
                        <h4 className="font-bold text-center mb-2 text-solarmente-title">SALDO PENDIENTE</h4>
                        <p className="text-sm text-solarmente-text mb-3">
                          El saldo pendiente se paga en 6 cuotas mensuales. La primera cuota se paga al
                          terminar la instalacion del sistema.
                        </p>
                        <div className="bg-gray-100 p-2 text-center rounded-md">
                          <span className="font-bold text-lg text-solarmente-title">${proposalData.precios.plan2.financiado.saldo.toLocaleString()}</span>
                        </div>
                      </div>
                      
                      <div className="border-t border-gray-200 pt-4 mb-6">
                        <h4 className="font-bold text-center mb-2 text-solarmente-title">CUOTA MENSUAL</h4>
                        <div className="bg-solarmente-button text-white p-2 text-center rounded-md">
                          <span className="font-bold text-lg">${proposalData.precios.plan2.financiado.cuotaMensual.toLocaleString()}</span>
                        </div>
                      </div>
                      
                      <div className="bg-solarmente-button text-white p-3 text-center rounded-md">
                        <h4 className="font-bold">GRAN TOTAL</h4>
                        <p className="text-2xl font-bold">${(proposalData.precios.plan2.financiado.abono + proposalData.precios.plan2.financiado.saldo * 1.05).toLocaleString()}</p>
                      </div>
                    </div>
                  </div>
                </div>
                
                <div className="flex justify-center mt-8">
                  <button className="bg-solarmente-button hover:bg-opacity-90 text-white font-bold py-3 px-8 rounded-lg shadow-lg transition duration-200">
                    Solicitar Instalación
                  </button>
                </div>
              </div>
            )}
            
            {activeTab === 'proyectos' && (
              <div>
                <h2 className="text-xl font-bold mb-6 text-solarmente-title">ALGUNOS PROYECTOS</h2>
                
                <div className="bg-solarmente-button text-white p-3 mb-6 rounded-md">
                  <h3 className="text-center font-semibold">ALGUNAS DE NUESTRAS INSTALACIONES - MAS DE 280 + INSTALACIONES RESIDENCIALES Y COMERCIALES!</h3>
                </div>
                
                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                  <div className="border border-gray-200 rounded-lg shadow-md overflow-hidden">
                    <div className="relative h-64">
                      <img src="/images/project1.jpg" alt="Proyecto Comercial" className="absolute inset-0 w-full h-full object-cover" />
                    </div>
                    <div className="p-4">
                      <div className="flex items-center justify-between mb-4">
                        <div className="flex items-center">
                          <img src="/images/longi-logo.png" alt="Longi" className="h-8 mr-2" />
                          <img src="/images/solis-logo.png" alt="Solis" className="h-8" />
                        </div>
                        <div className="bg-white border border-gray-200 px-3 py-1 rounded-full">
                          <p className="text-sm font-medium text-solarmente-text">157 PANELES SOLARES DE 585W</p>
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  <div className="border border-gray-200 rounded-lg shadow-md overflow-hidden">
                    <div className="relative h-64">
                      <img src="/images/project2.jpg" alt="Proyecto Residencial" className="absolute inset-0 w-full h-full object-cover" />
                    </div>
                    <div className="p-4">
                      <div className="flex items-center justify-between mb-4">
                        <div className="flex items-center">
                          <img src="/images/longi-logo.png" alt="Longi" className="h-8 mr-2" />
                          <img src="/images/solis-logo.png" alt="Solis" className="h-8" />
                        </div>
                        <div className="bg-white border border-gray-200 px-3 py-1 rounded-full">
                          <p className="text-sm font-medium text-solarmente-text">32 PANELES SOLARES DE 585W</p>
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  <div className="border border-gray-200 rounded-lg shadow-md overflow-hidden">
                    <div className="relative h-64">
                      <img src="/images/project3.jpg" alt="Proyecto Residencial" className="absolute inset-0 w-full h-full object-cover" />
                    </div>
                    <div className="p-4">
                      <div className="flex items-center justify-between mb-4">
                        <div className="flex items-center">
                          <img src="/images/longi-logo.png" alt="Longi" className="h-8 mr-2" />
                          <img src="/images/solis-logo.png" alt="Solis" className="h-8" />
                        </div>
                        <div className="bg-white border border-gray-200 px-3 py-1 rounded-full">
                          <p className="text-sm font-medium text-solarmente-text">26 PANELES SOLARES DE 585W</p>
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  <div className="border border-gray-200 rounded-lg shadow-md overflow-hidden">
                    <div className="relative h-64">
                      <img src="/images/project4.jpg" alt="Proyecto Residencial Múltiple" className="absolute inset-0 w-full h-full object-cover" />
                    </div>
                    <div className="p-4">
                      <div className="flex items-center justify-between mb-4">
                        <div className="flex items-center">
                          <img src="/images/longi-logo.png" alt="Longi" className="h-8 mr-2" />
                          <img src="/images/solis-logo.png" alt="Solis" className="h-8" />
                        </div>
                        <div className="bg-white border border-gray-200 px-3 py-1 rounded-full">
                          <p className="text-sm font-medium text-solarmente-text">4 CASAS EN COSTA DEL ESTE</p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                
                <div className="flex justify-center mt-8">
                  <Link 
                    href="/proyectos" 
                    className="bg-solarmente-button hover:bg-opacity-90 text-white font-bold py-3 px-8 rounded-lg shadow-lg transition duration-200"
                  >
                    Ver Más Proyectos
                  </Link>
                </div>
              </div>
            )}
          </div>
          
          {/* Footer */}
          <div className="bg-solarmente-button text-white p-4 flex justify-between items-center">
            <p className="font-semibold">Cambia de Energia</p>
            <p className="font-semibold">www.solarmente.io</p>
          </div>
        </div>
      </div>
    </main>
  );
}
